
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Enhancing Multispectral Color Composite Images</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-06-29"><meta name="DC.source" content="ipexlanstretch.m"><link rel="stylesheet" type="text/css" href="../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit ipexlanstretch">Open ipexlanstretch.m in the Editor</a></div><div class="right"><a href="matlab:echodemo ipexlanstretch">Run in the Command Window</a></div></div><div class="content"><h1>Enhancing Multispectral Color Composite Images</h1><!--introduction--><p>It is often necessary to enhance multispectral radiance or reflectance data to create an image that is suitable for visual interpretation.</p><p>This example illustrates some basic image composition and enhancement techniques for use with multispectral data.  It uses Landsat thematic mapper imagery covering part of Paris, France.  Seven spectral bands are stored in one file in the Erdas LAN format. Concepts covered include:</p><div><ul><li>Reading multispectral data from Erdas LAN files</li><li>Constructing color composites from different band combinations</li><li>Enhancing imagery with a contrast stretch</li><li>Enhancing imagery with a decorrelation stretch</li><li>Using scatterplots</li></ul></div><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Step 1: Construct Truecolor Composite from a Multispectral Image</a></li><li><a href="#3">Step 2: Use Histograms to Explore Un-Enhanced Truecolor Composite</a></li><li><a href="#4">Step 3: Use Correlation to Explore Un-Enhanced Truecolor Composite</a></li><li><a href="#6">Step 4: Enhance Truecolor Composite with a Contrast Stretch</a></li><li><a href="#7">Step 5: Check Histogram Following the Contrast Stretch</a></li><li><a href="#8">Step 6: Enhance Truecolor Composite with a Decorrelation Stretch</a></li><li><a href="#10">Step 7: Check Correlation Following the Decorrelation Stretch</a></li><li><a href="#11">Step 8: Construct and Enhance a CIR Composite</a></li></ul></div><h2>Step 1: Construct Truecolor Composite from a Multispectral Image<a name="1"></a></h2><p>The LAN file, <tt>paris.lan</tt>, contains a 7-band 512-by-512 Landsat image. A 128-byte header is followed by the pixel values, which are band interleaved by line (BIL) in order of increasing band number.  They are stored as unsigned 8-bit integers, in little-endian byte order.</p><p>Read bands 3, 2, and 1 from the LAN file using the MATLAB&reg; function <tt>multibandread</tt>.  These bands cover the visible part of the spectrum. When they are mapped to the red, green, and blue planes, respectively, of an RGB image, the result is a standard truecolor composite.  The final input argument to <tt>multibandread</tt> specifies which bands to read, and in which order, so that you can construct an RGB composite in a single step.</p><pre class="codeinput">truecolor = multibandread(<span class="string">'paris.lan'</span>, [512, 512, 7], <span class="string">'uint8=&gt;uint8'</span>, <span class="keyword">...</span>
                          128,  <span class="string">'bil'</span>, <span class="string">'ieee-le'</span>, {<span class="string">'Band'</span>,<span class="string">'Direct'</span>,[3 2 1]});
</pre><p>The truecolor composite has very little contrast and the colors are unbalanced.</p><pre class="codeinput">figure
imshow(truecolor);
title(<span class="string">'Truecolor Composite (Un-enhanced)'</span>)
text(size(truecolor,2), size(truecolor,1) + 15,<span class="keyword">...</span>
  <span class="string">'Image courtesy of Space Imaging, LLC'</span>,<span class="keyword">...</span>
  <span class="string">'FontSize'</span>, 7, <span class="string">'HorizontalAlignment'</span>, <span class="string">'right'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_01.png" alt=""> <h2>Step 2: Use Histograms to Explore Un-Enhanced Truecolor Composite<a name="3"></a></h2><p>By viewing a histogram of the red band, for example, you can see that the data is concentrated within a small part of the available dynamic range. This is one reason why the truecolor composite appears dull.</p><pre class="codeinput">figure
imhist(truecolor(:,:,1))
title(<span class="string">'Histogram of the Red Band (Band 3)'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_02.png" alt=""> <h2>Step 3: Use Correlation to Explore Un-Enhanced Truecolor Composite<a name="4"></a></h2><p>Another reason for the dull appearance of the composite is that the visible bands are highly correlated with each other.  Two- and three-band scatterplots are an excellent way to gauge the degree of correlation among spectral bands.  You can make them easily just by using <tt>plot</tt>.</p><pre class="codeinput">r = truecolor(:,:,1);
g = truecolor(:,:,2);
b = truecolor(:,:,3);
figure
plot3(r(:),g(:),b(:),<span class="string">'.'</span>)
grid(<span class="string">'on'</span>)
xlabel(<span class="string">'Red (Band 3)'</span>)
ylabel(<span class="string">'Green (Band 2)'</span>)
zlabel(<span class="string">'Blue (Band 1)'</span>)
title(<span class="string">'Scatterplot of the Visible Bands'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_03.png" alt=""> <p>The pronounced linear trend of the red-green-blue scatterplot indicates that the visible bands are highly correlated. This helps explain the monochromatic look of the un-enhanced truecolor composite.</p><h2>Step 4: Enhance Truecolor Composite with a Contrast Stretch<a name="6"></a></h2><p>When you use <tt>imadjust</tt> to apply a linear contrast stretch to the truecolor composite image, the surface features are easier to recognize.</p><pre class="codeinput">stretched_truecolor = imadjust(truecolor,stretchlim(truecolor));
figure
imshow(stretched_truecolor)
title(<span class="string">'Truecolor Composite after Contrast Stretch'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_04.png" alt=""> <h2>Step 5: Check Histogram Following the Contrast Stretch<a name="7"></a></h2><p>A histogram of the red band after applying a contrast stretch shows that the data has been spread over much more of the available dynamic range.</p><pre class="codeinput">figure
imhist(stretched_truecolor(:,:,1))
title(<span class="string">'Histogram of Red Band (Band 3) after Contrast Stretch'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_05.png" alt=""> <h2>Step 6: Enhance Truecolor Composite with a Decorrelation Stretch<a name="8"></a></h2><p>Another way to enhance the truecolor composite is to use a decorrelation stretch, which enhances color separation across highly correlated channels. Use <tt>decorrstretch</tt> to perform the decorrelation stretch (followed by a linear contrast stretch, as specified by the optional parameter-value pair <tt>'Tol'</tt> and <tt>0.1</tt>).</p><pre class="codeinput">decorrstretched_truecolor = decorrstretch(truecolor, <span class="string">'Tol'</span>, 0.01);
figure
imshow(decorrstretched_truecolor)
title(<span class="string">'Truecolor Composite after Decorrelation Stretch'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_06.png" alt=""> <p>Again, surface features have become much more clearly visible, but in a different way.  The spectral differences across the scene have been exaggerated.  A noticeable example is the area of green on the left edge, which appears black in the contrast-stretched composite. This green area is the Bois de Boulogne, a large park on the western edge of Paris.</p><h2>Step 7: Check Correlation Following the Decorrelation Stretch<a name="10"></a></h2><p>As expected, a scatterplot following the decorrelation stretch shows a strong decrease in correlation.</p><pre class="codeinput">r = decorrstretched_truecolor(:,:,1);
g = decorrstretched_truecolor(:,:,2);
b = decorrstretched_truecolor(:,:,3);
figure
plot3(r(:),g(:),b(:),<span class="string">'.'</span>)
grid(<span class="string">'on'</span>)
xlabel(<span class="string">'Red (Band 3)'</span>)
ylabel(<span class="string">'Green (Band 2)'</span>)
zlabel(<span class="string">'Blue (Band 1)'</span>)
title(<span class="string">'Scatterplot of the Visible Bands after Decorrelation Stretch'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_07.png" alt=""> <h2>Step 8: Construct and Enhance a CIR Composite<a name="11"></a></h2><p>Just as with the visible bands, information from Landsat bands covering non-visible portions of the spectrum can be viewed by constructing and enhancing RGB composite images.  The near infrared (NIR) band (Band 4) is important because of the high reflectance of chlorophyll in this part of the spectrum.  It is even more useful when combined with visible red and green (Bands 3 and 2, respectively) to form a color infrared (CIR) composite image. Color infrared (CIR) composites are commonly used to identify vegetation or assess its state of growth and/or health.</p><p>Construct a CIR composite by reading from the original LAN file and composing an RGB image that maps bands 4, 3, and 2 to red, green, and blue, respectively.</p><pre class="codeinput">CIR = multibandread(<span class="string">'paris.lan'</span>, [512, 512, 7], <span class="string">'uint8=&gt;uint8'</span>, <span class="keyword">...</span>
                    128,  <span class="string">'bil'</span>, <span class="string">'ieee-le'</span>, {<span class="string">'Band'</span>,<span class="string">'Direct'</span>,[4 3 2]});
</pre><p>Even though the near infrared (NIR) band (Band 4) is less correlated with the visible bands than the visible bands are with each other, a decorrelation stretch makes many features easier to see.</p><pre class="codeinput">stretched_CIR = decorrstretch(CIR, <span class="string">'Tol'</span>, 0.01);
figure
imshow(stretched_CIR)
title(<span class="string">'CIR after Decorrelation Stretch'</span>)
</pre><img vspace="5" hspace="5" src="ipexlanstretch_08.png" alt=""> <p>A property of color infrared composites is that they look red in areas with a high vegetation (chlorophyll) density. Notice that the Bois de Boulogne park is red in the CIR composite, which is consistent with its green appearance in the decorrelation-stretched truecolor composite.</p><p>See also <tt>decorrstretch</tt>, <tt>imhist</tt>, <tt>imadjust</tt>, <tt>multibandread</tt>, <tt>stretchlim</tt>.</p><p class="footer">Copyright 1993-2008 The MathWorks, Inc.<br>
          Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!--
##### SOURCE BEGIN #####
%% Enhancing Multispectral Color Composite Images
% It is often necessary to enhance multispectral radiance or reflectance 
% data to create an image that is suitable for visual interpretation.
%
% This example illustrates some basic image composition and enhancement
% techniques for use with multispectral data.  It uses Landsat thematic
% mapper imagery covering part of Paris, France.  Seven spectral bands are
% stored in one file in the Erdas LAN format. Concepts covered include:
% 
% * Reading multispectral data from Erdas LAN files
% * Constructing color composites from different band combinations
% * Enhancing imagery with a contrast stretch
% * Enhancing imagery with a decorrelation stretch
% * Using scatterplots

% Copyright 1993-2008 The MathWorks, Inc. 


%% Step 1: Construct Truecolor Composite from a Multispectral Image
% The LAN file, |paris.lan|, contains a 7-band 512-by-512 Landsat image. 
% A 128-byte header is followed by the pixel values, which are band
% interleaved by line (BIL) in order of increasing band number.  They
% are stored as unsigned 8-bit integers, in little-endian byte order.
%
% Read bands 3, 2, and 1 from the LAN file using the MATLAB(R) function
% |multibandread|.  These bands cover the visible part of the spectrum.
% When they are mapped to the red, green, and blue planes, respectively, of
% an RGB image, the result is a standard truecolor composite.  The final
% input argument to |multibandread| specifies which bands to read, and in
% which order, so that you can construct an RGB composite in a single step.
truecolor = multibandread('paris.lan', [512, 512, 7], 'uint8=>uint8', ...
                          128,  'bil', 'ieee-le', {'Band','Direct',[3 2 1]});

%%
% The truecolor composite has very little contrast and the colors are
% unbalanced.
figure
imshow(truecolor);
title('Truecolor Composite (Un-enhanced)')
text(size(truecolor,2), size(truecolor,1) + 15,...
  'Image courtesy of Space Imaging, LLC',...
  'FontSize', 7, 'HorizontalAlignment', 'right')

%% Step 2: Use Histograms to Explore Un-Enhanced Truecolor Composite
%
% By viewing a histogram of the red band, for example, you can see that the
% data is concentrated within a small part of the available dynamic range.
% This is one reason why the truecolor composite appears dull.
figure
imhist(truecolor(:,:,1))
title('Histogram of the Red Band (Band 3)')

%% Step 3: Use Correlation to Explore Un-Enhanced Truecolor Composite
% Another reason for the dull appearance of the composite is that the
% visible bands are highly correlated with each other.  Two- and three-band
% scatterplots are an excellent way to gauge the degree of correlation
% among spectral bands.  You can make them easily just by using |plot|.
r = truecolor(:,:,1);
g = truecolor(:,:,2);
b = truecolor(:,:,3);
figure 
plot3(r(:),g(:),b(:),'.')
grid('on')
xlabel('Red (Band 3)')
ylabel('Green (Band 2)')
zlabel('Blue (Band 1)')
title('Scatterplot of the Visible Bands')

%%
% The pronounced linear trend of the red-green-blue scatterplot indicates
% that the visible bands are highly correlated. This helps explain the
% monochromatic look of the un-enhanced truecolor composite.

%% Step 4: Enhance Truecolor Composite with a Contrast Stretch
% When you use |imadjust| to apply a linear contrast stretch to the
% truecolor composite image, the surface features are easier to recognize.
stretched_truecolor = imadjust(truecolor,stretchlim(truecolor));
figure
imshow(stretched_truecolor)
title('Truecolor Composite after Contrast Stretch')

%% Step 5: Check Histogram Following the Contrast Stretch
% A histogram of the red band after applying a contrast stretch shows that
% the data has been spread over much more of the available dynamic range. 
figure
imhist(stretched_truecolor(:,:,1))
title('Histogram of Red Band (Band 3) after Contrast Stretch')

%% Step 6: Enhance Truecolor Composite with a Decorrelation Stretch
% Another way to enhance the truecolor composite is to use a decorrelation
% stretch, which enhances color separation across highly correlated
% channels. Use |decorrstretch| to perform the decorrelation stretch
% (followed by a linear contrast stretch, as specified by the optional
% parameter-value pair |'Tol'| and |0.1|). 
decorrstretched_truecolor = decorrstretch(truecolor, 'Tol', 0.01);
figure
imshow(decorrstretched_truecolor)
title('Truecolor Composite after Decorrelation Stretch')

%%
% Again, surface features have become much more clearly visible, but in a
% different way.  The spectral differences across the scene have been
% exaggerated.  A noticeable example is the area of green on the left edge,
% which appears black in the contrast-stretched composite. This green area
% is the Bois de Boulogne, a large park on the western edge of Paris.

%% Step 7: Check Correlation Following the Decorrelation Stretch
% As expected, a scatterplot following the decorrelation stretch shows a
% strong decrease in correlation. 
r = decorrstretched_truecolor(:,:,1);
g = decorrstretched_truecolor(:,:,2);
b = decorrstretched_truecolor(:,:,3);
figure 
plot3(r(:),g(:),b(:),'.')
grid('on')
xlabel('Red (Band 3)')
ylabel('Green (Band 2)')
zlabel('Blue (Band 1)')
title('Scatterplot of the Visible Bands after Decorrelation Stretch')

%% Step 8: Construct and Enhance a CIR Composite
% Just as with the visible bands, information from Landsat bands covering
% non-visible portions of the spectrum can be viewed by constructing and
% enhancing RGB composite images.  The near infrared (NIR) band (Band 4) is
% important because of the high reflectance of chlorophyll in this part of
% the spectrum.  It is even more useful when combined with visible red and
% green (Bands 3 and 2, respectively) to form a color infrared (CIR) composite
% image. Color infrared (CIR) composites are commonly used to identify
% vegetation or assess its state of growth and/or health.

%%
% Construct a CIR composite by reading from the original LAN file and
% composing an RGB image that maps bands 4, 3, and 2 to red, green, and
% blue, respectively.
CIR = multibandread('paris.lan', [512, 512, 7], 'uint8=>uint8', ...
                    128,  'bil', 'ieee-le', {'Band','Direct',[4 3 2]});
 
%%
% Even though the near infrared (NIR) band (Band 4) is less correlated with
% the visible bands than the visible bands are with each other, a
% decorrelation stretch makes many features easier to see.
stretched_CIR = decorrstretch(CIR, 'Tol', 0.01);
figure
imshow(stretched_CIR)
title('CIR after Decorrelation Stretch')

%%
% A property of color infrared composites is that they look red in areas
% with a high vegetation (chlorophyll) density. Notice that the Bois de
% Boulogne park is red in the CIR composite, which is consistent with its
% green appearance in the decorrelation-stretched truecolor composite.

%%
% See also |decorrstretch|, |imhist|, |imadjust|, |multibandread|,
% |stretchlim|.


displayEndOfDemoMessage(mfilename)

##### SOURCE END #####
--></body></html>