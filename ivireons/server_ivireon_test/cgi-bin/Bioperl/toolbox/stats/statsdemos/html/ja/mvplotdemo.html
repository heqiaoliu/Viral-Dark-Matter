
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>多変量データの可視化</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-26"><meta name="DC.source" content="mvplotdemo.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit mvplotdemo">エディターで mvplotdemo.m を開く</a></div><div class="right"><a href="matlab:echodemo mvplotdemo">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>多変量データの可視化</h1><!--introduction--><p>統計分析の多くでは、予測変数と応答変数という 2 つの変数のみを使用します。このようなデータは、2 次元散布図、二変量ヒストグラム、ボックスプロットなどを使用すると容易に可視化できます。また、3 次元散布図、または色などでエンコードされた第 3 の変数を持つ 2 次元散布図を使用して、三変量データを可視化することも可能です。しかし、データセットの多くには、変数が多数含まれるため、直接的な可視化は困難です。このデモでは、Statistics Toolbox™ を使用して MATLAB&reg; で高次元データを可視化する方法をいくつか調べます。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#2">散布図行列</a></li><li><a href="#4">平行座標プロット</a></li><li><a href="#7">Andrews プロット</a></li><li><a href="#10">グリフ プロット</a></li><li><a href="#12">グリフ プロットと多次元尺度法</a></li></ul></div><p>このデモでは、<tt>carbig</tt> データセットを使用します。これは、1970 年代と 1980 年代の約 400 台の自動車について測定されたさまざまな変数を含むデータセットです。燃料効率 (ガロンあたりのマイル数、MPG)、加速度 (マイル時速が 0 から 60 に達するまでの秒数)、エンジン排気量 (立方インチ)、重量、および馬力の各値を使用した多変量の視覚化を示します。気筒数を使用して、観測値をグループ化します。</p><pre class="codeinput">load <span class="string">carbig</span>
X = [MPG,Acceleration,Displacement,Weight,Horsepower];
varNames = {<span class="string">'MPG'</span>; <span class="string">'Acceleration'</span>; <span class="string">'Displacement'</span>; <span class="string">'Weight'</span>; <span class="string">'Horsepower'</span>};
</pre><h2>散布図行列<a name="2"></a></h2><p>低次元の部分空間のスライスを表示することは、2 次元または 3 次元の制限を部分的に回避する方法の 1 つです。たとえば、関数 <tt>gplotmatrix</tt> を使用すると、5 つの変数間の二変量散布図すべての配列を、各変数の一変量ヒストグラムと共に表示することができます。</p><pre class="codeinput">figure
gplotmatrix(X,[],Cylinders,[<span class="string">'c'</span> <span class="string">'b'</span> <span class="string">'m'</span> <span class="string">'g'</span> <span class="string">'r'</span>],[],[],false);
text([.08 .24 .43 .66 .83], repmat(-.1,1,5), varNames, <span class="string">'FontSize'</span>,8);
text(repmat(-.12,1,5), [.86 .62 .41 .25 .02], varNames, <span class="string">'FontSize'</span>,8, <span class="string">'Rotation'</span>,90);
</pre><img vspace="5" hspace="5" src="../mvplotdemo_01.png" alt=""> <p>各散布図における点は、気筒数によって色分けされています。4 気筒の場合は青色、6 気筒の場合は緑色、8 気筒の場合は赤色です。さらに、少数の 5 気筒車も存在し、またロータリー エンジン車は 3 気筒車と見なされます。この一連のプロットにより、変数ペア間の関係のパターンを容易に特定できるようになります。ただし、高次元に重要なパターンが存在する場合があり、このようなパターンをこのプロットで容易に認識することはできません。</p><h2>平行座標プロット<a name="4"></a></h2><p>散布図行列には、二変量関係のみが表示されます。しかし、すべての変数を一緒に表示できる別の方法があります。この方法を利用すると、変数間の高次元の関係を調べることができます。最も簡単な多変量プロットは平行座標プロットです。このプロットでは、通常の直交座標グラフのように直交軸を使用するのではなく、座標軸がすべて水平に並べられます。各観測値はプロット内で、結合された一連の線分として表されます。たとえば、4 気筒、6 気筒、または 8 気筒のすべての自動車と、グループ別の色観測値のプロットを作成できます。</p><pre class="codeinput">Cyl468 = ismember(Cylinders,[4 6 8]);
parallelcoords(X(Cyl468,:), <span class="string">'group'</span>,Cylinders(Cyl468), <span class="keyword">...</span>
               <span class="string">'standardize'</span>,<span class="string">'on'</span>, <span class="string">'labels'</span>,varNames)
</pre><img vspace="5" hspace="5" src="../mvplotdemo_02.png" alt=""> <p>このプロットにおける水平方向は座標軸を表し、垂直方向はデータを表しています。各観測値は 5 つの変数に対する測定値から成り、各測定値は、対応する線が各座標軸と交差する高さとして表されます。5 つの変数の範囲は大きく異なるため、このプロットは標準値 (ゼロ平均と単位分散を持つように各変数が標準化されている) で作成されています。グラフで色分けを利用することで、たとえば、8 気筒車では通常、MPG と加速度の値が低く、排気量、重量、および馬力の値が高いことなどがわかるようになります。</p><p>グループ別に色分けすると、多数の観測値を含む平行座標プロットが読み取りにくくなることがあります。また、各グループについて中央値と四分位点 (25% と 75% の点) のみが表示される平行座標プロットを作成することもできます。これにより、グループ間の典型的な相違点と類似点を容易に識別できるようになります。他方では、各グループの異常値に対して最も関心がある場合がありますが、このプロットでは、このような異常値はまったく示されません。</p><pre class="codeinput">parallelcoords(X(Cyl468,:), <span class="string">'group'</span>,Cylinders(Cyl468), <span class="keyword">...</span>
               <span class="string">'standardize'</span>,<span class="string">'on'</span>, <span class="string">'labels'</span>,varNames, <span class="string">'quantile'</span>,.25)
</pre><img vspace="5" hspace="5" src="../mvplotdemo_03.png" alt=""> <h2>Andrews プロット<a name="7"></a></h2><p>同様のタイプの多変量視覚化方法が Andrews プロットです。このプロットは、区間 [0,1] における平滑関数として各観測値を表します。</p><pre class="codeinput">andrewsplot(X(Cyl468,:), <span class="string">'group'</span>,Cylinders(Cyl468), <span class="string">'standardize'</span>,<span class="string">'on'</span>)
</pre><img vspace="5" hspace="5" src="../mvplotdemo_04.png" alt=""> <p>各関数は、対応する観測値に係数が等しいフーリエ級数です。この例では、フーリエ級数は 5 つの項を持っています。すなわち、1 つの定数、周期が 1 と 1/2 の 2 つの正弦項、および 2 つの類似した余弦項です。最初の 3 つの項による、関数の形状に対する影響は Andrews プロットで最も顕著であるため、最初の 3 つの変数のパターンが最も容易に認識しやすい傾向にあります。</p><p>t = 0 の時点においてグループ間に明白な相違がありますが、これは、最初の変数 MPG が、4 気筒車、6 気筒車、および 8 気筒車の間の際立った特徴の 1 つであることを示しています。より興味深いのは、t = 1/3 の辺りにおける 3 つのグループ間の相違です。この値を Andrews プロット関数の式に当てはめると、グループ間を識別する、変数の線形結合を定義する係数の集合が得られます。</p><pre class="codeinput">t1 = 1/3;
[1/sqrt(2) sin(2*pi*t1) cos(2*pi*t1) sin(4*pi*t1) cos(4*pi*t1)]
</pre><pre class="codeoutput">
ans =

    0.7071    0.8660   -0.5000   -0.8660   -0.5000

</pre><p>これらの係数から、以下のことを確認できます。すなわち、4 気筒車を 8 気筒車から識別する 1 つの方法は、前者は MPG と加速度の値が高く、排気量、馬力、および特に馬力が低いが、後者はその反対である、ということです。これは、平行座標プロットから引き出された結論と同じです。</p><h2>グリフ プロット<a name="10"></a></h2><p>多変量データを視覚化する別の方法では、&quot;グリフ&quot; を使用して次元を表します。関数 <tt>glyphplot</tt> は、スターとチャーノフの顔という 2 つのタイプのグリフをサポートします。例として、自動車データの最初の 9 つのモデルのスター プロットを以下に示しています。スター内の各スポークは 1 つの変数を表し、スポークの長さは、各観測の変数の値に比例します。</p><pre class="codeinput">h = glyphplot(X(1:9,:), <span class="string">'glyph'</span>,<span class="string">'star'</span>, <span class="string">'varLabels'</span>,varNames, <span class="string">'obslabels'</span>,Model(1:9,:));
set(h(:,3),<span class="string">'FontSize'</span>,8);
</pre><img vspace="5" hspace="5" src="../mvplotdemo_05.png" alt=""> <p>アクティブな MATLAB figure ウィンドウでは、このプロットにより、データ カーソルを使用してデータ値を対話形式で調べることができます。たとえば、Ford Torino のスターの右側のポイントをクリックすると、この自動車の MPG 値が 17 であることが示されます。</p><h2>グリフ プロットと多次元尺度法<a name="12"></a></h2><p>任意の順序でグリッド上にスターをプロットすると、隣接するスターの外観がまったく異なってしまって、図がわかりにくくなることがあります。このような場合、認識できるスムーズなパターンがなくなります。この問題を回避する方法として、多次元尺度法 (MDS) をグリフ プロットの組み合わせが役に立ちます。このことを示すために、まず、1977 年のすべての自動車を選択し、関数 <tt>zscore</tt> を使用して、5 つの各変数を、平均 0 と分散 1 を持つように標準化します。次に、これらの標準化された観測値間のユークリッド距離を非類似度の尺度として計算します。この選択は、実際に利用するには単純すぎますが、例示目的としてはわかりやすいでしょう。</p><pre class="codeinput">models77 = find((Model_Year==77));
dissimilarity = pdist(zscore(X(models77,:)));
</pre><p>最後に、<tt>mdscale</tt> を使用して、点間距離が元の高次元データ間の非類似度に近似するような、2 次元の位置の集合を作成し、これらの位置を使用してグリフをプロットします。この 2 次元プロットにおける距離によってデータは大ざっぱにしか再現されませんが、このタイプのプロットではこの程度で十分です。</p><pre class="codeinput">Y = mdscale(dissimilarity,2);
glyphplot(X(models77,:), <span class="string">'glyph'</span>,<span class="string">'star'</span>, <span class="string">'centers'</span>,Y, <span class="keyword">...</span>
          <span class="string">'varLabels'</span>,varNames, <span class="string">'obslabels'</span>,Model(models77,:), <span class="string">'radius'</span>,.5);
title(<span class="string">'1977 Model Year'</span>);
</pre><img vspace="5" hspace="5" src="../mvplotdemo_06.png" alt=""> <p>このプロットでは、低次元化方法として MDS を使用して、2 次元プロットを作成しました。通常、これは情報の損失を意味しますが、グリフをプロットすることで、すべての高次元情報をデータに組み込むことができました。MDS を使用する目的は、データの変化に一定の規則性を持たせて、グリフ間のパターンを認識しやすくすることです。</p><p>上記のプロットと同様に、アクティブな figure ウィンドウでは、対話形式で調べることが可能です。</p><p>別のタイプのグリフは、チャーノフの顔です。このグリフは、各観測のデータ値を顔の特徴 (顔の大きさ、顔の形、目の位置など) にエンコードします。</p><pre class="codeinput">glyphplot(X(models77,:), <span class="string">'glyph'</span>,<span class="string">'face'</span>, <span class="string">'centers'</span>,Y, <span class="keyword">...</span>
          <span class="string">'varLabels'</span>,varNames, <span class="string">'obslabels'</span>,Model(models77,:));
title(<span class="string">'1977 Model Year'</span>);
</pre><img vspace="5" hspace="5" src="../mvplotdemo_07.png" alt=""> <p>ここでは、最もわかりやすい 2 つの特徴 (顔の大きさと相対的な額/顎の大きさ) によって MPG と加速度がエンコードされ、額と顎の形によって排気量と重量がエンコードされています。両目の間隔の広さによって馬力がエンコードされています。注目すべきは、額が広くて顎が狭い顔または額が狭くて顎が広い顔が少ないということです。これは、排気量と重量の変数間に正の線形相関があることを示しています。このことは、散布図行列の場合と同様です。</p><p>特徴と変数との対応により、どの関係が最も認識しやすいかが決まり、<tt>glyphplot</tt> により、選択を容易に変更できるようになります。</p><pre class="codeinput">close
</pre><p class="footer">Copyright 2004-2009 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Visualizing Multivariate Data % Many statistical analyses involve only two variables: a predictor % variable and a response variable.  Such data are easy to visualize using % 2D scatter plots, bivariate histograms, boxplots, etc.  It's also % possible to visualize trivariate data with 3D scatter plots, or 2D % scatter plots with a third variable encoded with, for example color. % However, many datasets involve a larger number of variables, making % direct visualization more difficult.  This demo explores some of the ways % to visualize high-dimensional data in MATLAB(R), using the Statistics Toolbox(TM).  %   Copyright 2004-2009 The MathWorks, Inc. %   $Revision: 1.1.8.2.2.1 $  $Date: 2010/07/29 21:29:29 $  %% % In this demo, we'll use the |carbig| dataset, a dataset that contains % various measured variables for about 400 automobiles from the 1970's and % 1980's.  We'll illustrate multivariate visualization using the values for % fuel efficiency (in miles per gallon, MPG), acceleration (time from % 0-60MPH in sec), engine displacement (in cubic inches), weight, and % horsepower.  We'll use the number of cylinders to group observations. load carbig X = [MPG,Acceleration,Displacement,Weight,Horsepower]; varNames = {'MPG'; 'Acceleration'; 'Displacement'; 'Weight'; 'Horsepower'};  %% Scatterplot Matrices % Viewing slices through lower dimensional subspaces is one way to % partially work around the limitation of two or three dimensions.  For % example, we can use the |gplotmatrix| function to display an array of all % the bivariate scatterplots between our five variables, along with a % univariate histogram for each variable. figure gplotmatrix(X,[],Cylinders,['c' 'b' 'm' 'g' 'r'],[],[],false); text([.08 .24 .43 .66 .83], repmat(-.1,1,5), varNames, 'FontSize',8); text(repmat(-.12,1,5), [.86 .62 .41 .25 .02], varNames, 'FontSize',8, 'Rotation',90);  %% % The points in each scatterplot are color-coded by the number of % cylinders: blue for 4 cylinders, green for 6, and red for 8.  There is % also a handful of 5 cylinder cars, and rotary-engined cars are listed as % having 3 cylinders.  This array of plots makes it easy to pick out % patterns in the relationships between pairs of variables.  However, there % may be important patterns in higher dimensions, and those are not easy % to recognize in this plot.   %% Parallel Coordinates Plots % The scatterplot matrix only displays bivariate relationships.  However, % there are other alternatives that display all the variables together, % allowing you to investigate higher-dimensional relationships among % variables.  The most straight-forward multivariate plot is the % parallel coordinates plot.  In this plot, the coordinate axes are all % laid out horizontally, instead of using orthogonal axes as in the usual % Cartesian graph.  Each observation is represented in the plot as a series % of connected line segments.  For example, we can make a plot of all the % cars with 4, 6, or 8 cylinders, and color observations by group. Cyl468 = ismember(Cylinders,[4 6 8]); parallelcoords(X(Cyl468,:), 'group',Cylinders(Cyl468), ...                'standardize','on', 'labels',varNames)  %% % The horizontal direction in this plot represents the coordinate axes, and % the vertical direction represents the data.  Each observation consists of % measurements on five variables, and each measurement is represented as % the height at which the corresponding line crosses each coordinate axis. % Because the five variables have widely different ranges, this plot was % made with standardized values, where each variable has been standardized % to have zero mean and unit variance.  With the color coding, the graph % shows, for example, that 8 cylinder cars typically have low values for % MPG and acceleration, and high values for displacement, weight, and % horsepower.  %% % Even with color coding by group, a parallel coordinates plot with a large % number of observations can be difficult to read.  We can also make a % parallel coordinates plot where only the median and quartiles (25% and 75% % points) for each group are shown.  This makes the typical differences and % similarities among groups easier to distinguish.  On the other hand, it % may be the outliers for each group that are most interesting, and this % plot does not show them at all. parallelcoords(X(Cyl468,:), 'group',Cylinders(Cyl468), ...                'standardize','on', 'labels',varNames, 'quantile',.25)   %% Andrews Plots % Another similar type of multivariate visualization is the Andrews plot. % This plot represents each observation as a smooth function over the % interval [0,1]. andrewsplot(X(Cyl468,:), 'group',Cylinders(Cyl468), 'standardize','on')  %% % Each function is a Fourier series, with coefficients equal to the % corresponding observation's values.  In this example, the series has five % terms: a constant, two sine terms with periods 1 and 1/2, and two similar % cosine terms.  Effects on the functions' shapes due to the three leading % terms are the most apparent in an Andrews plot, so patterns in the first % three variables tend to be the ones most easily recognized. % % There's a distinct difference between groups at t = 0, indicating that % the first variable, MPG, is one of the distinguishing features between 4, % 6, and 8 cylinder cars.  More interesting is the difference between the % three groups at around t = 1/3.  Plugging this value into the formula % for the Andrews plot functions, we get a set of coefficients that define a % linear combination of the variables that distinguishes between groups. t1 = 1/3; [1/sqrt(2) sin(2*pi*t1) cos(2*pi*t1) sin(4*pi*t1) cos(4*pi*t1)]  %% % From these coefficients, we can see that one way to distinguish 4 % cylinder cars from 8 cylinder cars is that the former have higher values % of MPG and acceleration, and lower values of displacement, horsepower, % and particularly weight, while the latter have the opposite.  That's the % same conclusion we drew from the parallel coordinates plot.   %% Glyph Plots % Another way to visualize multivariate data is to use "glyphs" to % represent the dimensions.  The function |glyphplot| supports two types of % glyphs:  stars, and Chernoff faces.  For example, here is a star plot of % the first 9 models in the car data.  Each spoke in a star represents one % variable, and the spoke length is proportional to the value of that % variable for that observation. h = glyphplot(X(1:9,:), 'glyph','star', 'varLabels',varNames, 'obslabels',Model(1:9,:)); set(h(:,3),'FontSize',8);  %% % In a live MATLAB figure window, this plot would allow interactive % exploration of the data values, using data cursors.  For example, % clicking on the right-hand point of the star for the Ford Torino would % show that it has an MPG value of 17.   %% Glyph Plots and Multidimensional Scaling % Plotting stars on a grid, with no particular order, can lead to a figure % that is confusing, because adjacent stars can end up quite % different-looking.  Thus, there may be no smooth pattern for the eye to % catch.  It's often useful to combine multidimensional scaling (MDS) with % a glyph plot.  To illustrate, we'll first select all cars from 1977, and % use the |zscore| function to standardize each of the five variables to % have zero mean and unit variance.  Then we'll compute the Euclidean % distances among those standardized observations as a measure of % dissimilarity.  This choice might be too simplistic in a real % application, but serves here for purposes of illustration. models77 = find((Model_Year==77)); dissimilarity = pdist(zscore(X(models77,:)));  %% % Finally, we use |mdscale| to create a set of locations in two dimensions % whose interpoint distances approximate the dissimilarities among the % original high-dimensional data, and plot the glyphs using those % locations.  The distances in this 2D plot may only roughly reproduce the % data, but for this type of plot, that's good enough. Y = mdscale(dissimilarity,2); glyphplot(X(models77,:), 'glyph','star', 'centers',Y, ...           'varLabels',varNames, 'obslabels',Model(models77,:), 'radius',.5); title('1977 Model Year');  %% % In this plot, we've used MDS as dimension reduction method, to create a % 2D plot.  Normally that would mean a loss of information, but by plotting % the glyphs, we have incorporated all of the high-dimensional information % in the data.  The purpose of using MDS is to impose some regularity to % the variation in the data, so that patterns among the glyphs are easier % to see.  %% % Just as with the previous plot, interactive exploration would be possible % in a live figure window.  %% % Another type of glyph is the Chernoff face.  This glyph encodes the data % values for each observation into facial features, such as the size of the % face, the shape of the face, position of the eyes, etc. glyphplot(X(models77,:), 'glyph','face', 'centers',Y, ...           'varLabels',varNames, 'obslabels',Model(models77,:)); title('1977 Model Year');  %% % Here, the two most apparent features, face size and relative forehead/jaw % size, encode MPG and acceleration, while the forehead and jaw shape % encode displacement and weight.  Width between eyes encodes horsepower. % It's notable that there are few faces with wide foreheads and narrow % jaws, or vice-versa, indicating positive linear correlation between the % variables displacement and weight.  That's also what we saw in the % scatterplot matrix. % % The correspondence of features to variables determines what relationships % are easiest to see, and |glyphplot| allows the choice to be changed easily.   %% close   displayEndOfDemoMessage(mfilename) ##### SOURCE END ##### --></body></html>